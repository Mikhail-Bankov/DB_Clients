# DB_Clients
Проект на VBA, созданный для облегчения работы по обзвону и формированию писем для клиентов.

И так, для чего же все это?

Данный проект создавался для фирмы по установке и замене фильтровального оборудования для воды. Написать полноценную программу было можно, но не позволял бюджет, да и исходя из позиции достаточного - это попросту было не нужно. Основной задачей стояла автоматизация обзвона клиентов (за 7 дней) и формирования для них писем с извещениями (за 30 дней). Учитывая количество клиентов (а это более 15000 человек), автоматизация процесса должна была сэкономить человеко-дни и даже недели.

Что может данный проект и как работает?

При запуске Excel-файла открывается окно программы, в котором доступны следующие кнопки:

Раздел "Подготовка писем (за 30 дней)":
- Кнопка "Отфильтровать 7 дней и менее" - отфильтровывает клиентов, до даты замены оборудования у которых, осталось 7 и менее дней (до нуля включительно);

Раздел "Обзвон клиентов (за 7 дней)":
- Кнопка "Сформировать письма" - одна из основных функций программы. При нажатии, запускается алгоритм, который проверяет количество дней до даты замены оборудования. Если осталось 30 и менее дней (до нуля включительно), то проверяется наличие отметки о дате формирования письма. Тут запускается следующая проверка:
  - Если отметка с датой формирования письма существует - она проверяется на вхождение в диапазон проверяемых выше 30 дней. Данная проверка добавлена для того, чтобы при формировании писем каждый день, ранее созданные письма не были пересозданы заново и не создавалась путаница; 
  - Если отметка существует, но не входит в данный диапазон дат, значит письмо было сформировано перед прошлой заменой оборудования и ранее, соответственно письмо создается заново, а отметка перезаписывается текущей датой; 
  - Если отметка отсутствует - создается письмо и ставится отметка с текущей датой. 

  При создании письма для текущего клиента дополнительно запускается проверка на наличие необходимых полей:
  - При отсутствиии "ФИО", вместо него проставляется "Уважаемый клиент";
  - При отстутствии одного из полей адреса (Индекс, Город, Адрес) - создание письма прекращается, так как не имеет смысл создавать "письмо в никуда".
По окончании создания всех писем отображается информационное окно с отображением количества созданных писем. Если количество созданных писем больше нуля, в Проводнике открывается папка "Письма", созданная программой "рядом" с файлами проекта. Каждое письмо при этом находится в папке с названием Города, взятом из колонки "А" текущего клиента. Если ячейка была пуста - письмо создается в папке с названием "Разобрать".
- Кнопка "Открыть папку с письмами" - открывает в Проводнике папку "Письма", речь о которой шла в предыдущем пункте.

Раздел "Поиск отсутствующих данных":
- Кнопка "Отсутствует номер договора";
- Кнопка "Отсутствует тип оборудования";
- Кнопка "Отсутствует ФИО клиента";
- Кнопка "Отсутствует индекс";
- Кнопка "Отсутствует город";
- Кнопка "Отсутствует адрес";
- Кнопка "Отсутствует телефон";
- Кнопка "Отсутствует дата замены".

Вышеперечисленные кнопки отфильтровывают клиентов, у которых отсутствуют записи в соответствующих полях.
- Кнопка "Сбросить все фильтры" - снимает все фильтры, созданные вышеперечисленными кнопками.

Раздел "Исправление ошибок (в крайнем случае)":
- Кнопка "Исправить формат ячеек" - исправляет формат ячеек в колонках I, J и M на формат даты ДД.ММ.ГГГГ (применяется ко всей колонке);
- Кнопка "Исправить формулы" - исправляет формулы для расчета дней в колонках J и K (применяется ко всем не пустым строкам в колонке).
----------------------------------
- Кнопка "Скрыть это меню" - скрывает форму программы. Для повторного отображения формы, необходимо нажать кнопку "Показать меню" в левом верхнем углу таблицы (в ячейке А1). 

Как начать пользоваться проектом?

Все, что необходимо:
- Скачать файлы (DB_clients_v.1.2.xlsm и LetterTemplate.docx) и положить их в одну папку в любом удобном для Вас расположении;
- Выдать данным файлам все разрешения на запуск макросов и т.д.;
- Исправить шаблон письма (LetterTemplate.docx) под свою организацию. Изначально файл сформирован таким образом, чтобы после сложения распечатанной первой страницы в трое, адрес клиента находился в правом нижнем окошке специального конверта;
- Наполнить базу данных клиентов (DB_clients_v.1.2.xlsm);
- Нажимать кнопки и проверять функционал :).
